@echo off

rem Check if PsExec is installed
where psexec >nul 2>nul
if %errorlevel% neq 0 (
    rem PsExec is not installed, run installers based on system architecture
    if "%PROCESSOR_ARCHITECTURE%"=="AMD64" (
        echo PsExec is not installed. This is a x64 system. Now running x64 PsExec Installer...
        rem Run the x64 PsExec installer
        start "PsExec64 Installer" "C:\Users\dud\Downloads\SysinternalsSuite\PsExec64.exe"
    ) else (
        echo PsExec is not installed. This is a x86 system. Now running x86 PsExec Installer...
        rem Run the x86 PsExec installer
        start "PsExec Installer" "C:\Users\dud\Downloads\SysinternalsSuite\PsExec.exe"
    )
) else (
    rem PsExec is installed, check system architecture
    if "%PROCESSOR_ARCHITECTURE%"=="AMD64" (
        echo PsExec is installed. This is a x64 system. Now running PsExec Installer...
        rem Run the 64-bit installer
        start "PsExec64 Installer" "C:\Users\dud\Downloads\SysinternalsSuite\PsExec64.exe"
    ) else (
        echo PsExec is installed. This is a x86 system. Now running PsExec Installer...
        rem Run the 32-bit installer
        start "PsExec Installer" "C:\Users\dud\Downloads\SysinternalsSuite\PsExec.exe"
    )
)

rem Run the .reg file
echo Applying registry changes...
regedit /s "C:\path\to\your\file.reg"

rem Prompt for restart
echo.
echo Restarting the system in 10 seconds...
timeout /t 10 /nobreak
shutdown /r /t 0

pause
